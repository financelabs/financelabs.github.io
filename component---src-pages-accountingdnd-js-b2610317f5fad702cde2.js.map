{"version":3,"file":"component---src-pages-accountingdnd-js-b2610317f5fad702cde2.js","mappings":"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","sources":["webpack://@r-ichard/gatsby-starter-bootstrap-5/./node_modules/@restart/ui/esm/Button.js","webpack://@r-ichard/gatsby-starter-bootstrap-5/./src/pages/accountingdnd.js","webpack://@r-ichard/gatsby-starter-bootstrap-5/./node_modules/react-bootstrap/esm/Button.js"],"sourcesContent":["const _excluded = [\"as\", \"disabled\"];\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\nimport * as React from 'react';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport function isTrivialHref(href) {\n  return !href || href.trim() === '#';\n}\nexport function useButtonProps({\n  tagName,\n  disabled,\n  href,\n  target,\n  rel,\n  role,\n  onClick,\n  tabIndex = 0,\n  type\n}) {\n  if (!tagName) {\n    if (href != null || target != null || rel != null) {\n      tagName = 'a';\n    } else {\n      tagName = 'button';\n    }\n  }\n  const meta = {\n    tagName\n  };\n  if (tagName === 'button') {\n    return [{\n      type: type || 'button',\n      disabled\n    }, meta];\n  }\n  const handleClick = event => {\n    if (disabled || tagName === 'a' && isTrivialHref(href)) {\n      event.preventDefault();\n    }\n    if (disabled) {\n      event.stopPropagation();\n      return;\n    }\n    onClick == null ? void 0 : onClick(event);\n  };\n  const handleKeyDown = event => {\n    if (event.key === ' ') {\n      event.preventDefault();\n      handleClick(event);\n    }\n  };\n  if (tagName === 'a') {\n    // Ensure there's a href so Enter can trigger anchor button.\n    href || (href = '#');\n    if (disabled) {\n      href = undefined;\n    }\n  }\n  return [{\n    role: role != null ? role : 'button',\n    // explicitly undefined so that it overrides the props disabled in a spread\n    // e.g. <Tag {...props} {...hookProps} />\n    disabled: undefined,\n    tabIndex: disabled ? undefined : tabIndex,\n    href,\n    target: tagName === 'a' ? target : undefined,\n    'aria-disabled': !disabled ? undefined : disabled,\n    rel: tagName === 'a' ? rel : undefined,\n    onClick: handleClick,\n    onKeyDown: handleKeyDown\n  }, meta];\n}\nconst Button = /*#__PURE__*/React.forwardRef((_ref, ref) => {\n  let {\n      as: asProp,\n      disabled\n    } = _ref,\n    props = _objectWithoutPropertiesLoose(_ref, _excluded);\n  const [buttonProps, {\n    tagName: Component\n  }] = useButtonProps(Object.assign({\n    tagName: asProp,\n    disabled\n  }, props));\n  return /*#__PURE__*/_jsx(Component, Object.assign({}, props, buttonProps, {\n    ref: ref\n  }));\n});\nButton.displayName = 'Button';\nexport default Button;","import * as React from \"react\";\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport Layout from \"../components/layout\"\r\nimport { Seo } from \"../components/seo\"\r\n\r\nimport {\r\n    selectCaseArray,\r\n    selectCaseArrayTrash,\r\n    seedArray,\r\n    selectedCase,\r\n   // selectCaseKey,\r\n   // selectSelectedNote,\r\n    //    setStoreObject,\r\n    selectCaseDNDArrayFinal,\r\n    //   selectCaseDNDArrayInitial\r\n} from \"../features/case/caseSlice\";\r\n\r\nimport { selectApplication } from \"../features/application/applicationSlice\";\r\n\r\nimport DragAndDrop from \"../components/DragAndDrop\";\r\n\r\nimport Row from \"react-bootstrap/Row\";\r\n// import Col from \"react-bootstrap/Col\";\r\n// import Form from \"react-bootstrap/Form\";\r\nimport Container from \"react-bootstrap/Container\";\r\nimport Button from \"react-bootstrap/Button\";\r\n\r\nimport pushKeyFirebaseNode from \"../features/firebase/pushKeyFirebaseNode\";\r\nimport updateFirebaseNode from \"../features/firebase/updateFirebaseNode\";\r\n\r\n\r\nfunction SavePosts() {\r\n    const dispatch = useDispatch();\r\n    const currentCase = useSelector(selectedCase);\r\n\r\n    // React.useEffect(() => {\r\n    //     console.log(updateKey);\r\n    //   //  console.log(sortedRecords);\r\n    //   }, [updateKey]);\r\n\r\n    const sortedRecords = useSelector(selectCaseDNDArrayFinal);\r\n    const applicationState = useSelector(selectApplication);\r\n\r\n    function doSave() {\r\n     //   console.log(sortedRecords);\r\n        \r\n        dispatch(seedArray({\r\n            arrayName: \"caseArray\",\r\n            arrayItems: sortedRecords.filter(item => item.dndcolumn === \"Проводки\")\r\n        }));\r\n        dispatch(seedArray({\r\n            arrayName: \"caseArrayTrash\",\r\n            arrayItems: sortedRecords.filter(item => item.dndcolumn === \"Корзина\")\r\n        }));\r\n\r\n        console.log(applicationState);\r\n\r\n         if (!!applicationState?.email && !!currentCase?.id) {\r\n             let userEmail = applicationState.email.replace(/[^a-zA-Z0-9]/g, \"_\");\r\n             let updates = {};\r\n             sortedRecords\r\n             .filter(item => item.dndcolumn === \"Проводки\")\r\n             .forEach((element, index) => {\r\n                let {dndcolumn, ...rest} = element;\r\n                 updates[\"/usersCraft/\" + userEmail + \"/posts/\" + currentCase.id + \"/content/\" +index]  = rest;\r\n             });\r\n             sortedRecords\r\n             .filter(item => item.dndcolumn === \"Корзина\")\r\n             .forEach((element, index) => {\r\n                let {dndcolumn, ...rest} = element;\r\n                 updates[\"/usersCraft/\" + userEmail + \"/posts/\" + currentCase.id + \"/trash/\" +index]  = rest;\r\n             });\r\n             console.log(updates);\r\n           updateFirebaseNode(updates, \"reload\");\r\n        }\r\n    }\r\n\r\n\r\n    return <Container>\r\n        \r\n        <Row>\r\n            <div className=\"d-grid gap-2 m-2\">\r\n                <Button variant=\"outline-secondary\" size=\"sm\" onClick={() => doSave()}>\r\n                    Сохранить изменения в проекте\r\n                </Button>\r\n            </div>\r\n        </Row>\r\n\r\n\r\n    </Container>\r\n}\r\n\r\nfunction AcountingDND() {\r\n    const dispatch = useDispatch();\r\n    const records = useSelector(selectCaseArray);\r\n    const trashRecords = useSelector(selectCaseArrayTrash);\r\n\r\n    React.useEffect(() => {\r\n        console.log('Records DnD');\r\n\r\n        let caseDNDArrayInitialRecords = records\r\n            .map(item => {\r\n                return {\r\n                    id: !!item?.id ? item.id : pushKeyFirebaseNode(\"/usersCraft/\"),\r\n                    dndcontent: item.d + \" / \" + item.k + \" \" + item.type + \" \" + item.sum,\r\n                    dndcolumn: \"Проводки\",\r\n                    ...item\r\n                }\r\n            });\r\n\r\n        let caseDNDArrayInitialTrashRecords = trashRecords\r\n            .map(item => {\r\n                return {\r\n                    id: !!item?.id ? item.id : pushKeyFirebaseNode(\"/usersCraft/\"),\r\n                    dndcontent: item.d + \" / \" + item.k + \" \" + item.type + \" \" + item.sum,\r\n                    dndcolumn: \"Корзина\",\r\n                    ...item\r\n                }\r\n            });\r\n\r\n        let caseDNDArrayInitial = [\r\n            ...caseDNDArrayInitialRecords,\r\n            ...caseDNDArrayInitialTrashRecords\r\n        ];\r\n\r\n\r\n        dispatch(seedArray({\r\n            arrayName: \"caseDNDArrayFinal\",\r\n            arrayItems: caseDNDArrayInitial\r\n        }));\r\n\r\n        dispatch(seedArray({\r\n            arrayName: \"caseDndItemsArray\",\r\n            arrayItems: caseDNDArrayInitialRecords\r\n        }));\r\n\r\n        dispatch(seedArray({\r\n            arrayName: \"caseDndItems2Array\",\r\n            arrayItems: caseDNDArrayInitialTrashRecords\r\n        }));\r\n\r\n\r\n    }, [])\r\n\r\n    return <Layout>\r\n        <div className=\"container text-center my-5\">\r\n            <SavePosts />\r\n            <DragAndDrop />\r\n            {/* <ViewItem /> */}\r\n\r\n\r\n        </div>\r\n    </Layout>\r\n}\r\n\r\nexport default AcountingDND\r\n\r\nexport const Head = () => (\r\n    <Seo title=\"Accounting records Drag and Drop\" />\r\n)\r\n\r\n\r\n\r\n\r\n\r\n","import classNames from 'classnames';\nimport * as React from 'react';\nimport { useButtonProps } from '@restart/ui/Button';\nimport { useBootstrapPrefix } from './ThemeProvider';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nconst defaultProps = {\n  variant: 'primary',\n  active: false,\n  disabled: false\n};\nconst Button = /*#__PURE__*/React.forwardRef(({\n  as,\n  bsPrefix,\n  variant,\n  size,\n  active,\n  className,\n  ...props\n}, ref) => {\n  const prefix = useBootstrapPrefix(bsPrefix, 'btn');\n  const [buttonProps, {\n    tagName\n  }] = useButtonProps({\n    tagName: as,\n    ...props\n  });\n  const Component = tagName;\n  return /*#__PURE__*/_jsx(Component, {\n    ...buttonProps,\n    ...props,\n    ref: ref,\n    className: classNames(className, prefix, active && 'active', variant && `${prefix}-${variant}`, size && `${prefix}-${size}`, props.href && props.disabled && 'disabled')\n  });\n});\nButton.displayName = 'Button';\nButton.defaultProps = defaultProps;\nexport default Button;"],"names":["_excluded","useButtonProps","tagName","disabled","href","target","rel","role","onClick","tabIndex","type","meta","handleClick","event","trim","isTrivialHref","preventDefault","stopPropagation","undefined","onKeyDown","key","Button","_ref","ref","as","asProp","props","source","excluded","i","sourceKeys","Object","keys","length","indexOf","_objectWithoutPropertiesLoose","buttonProps","Component","assign","displayName","SavePosts","dispatch","useDispatch","currentCase","useSelector","selectedCase","sortedRecords","selectCaseDNDArrayFinal","applicationState","selectApplication","React","Container","Row","className","variant","size","seedArray","arrayName","arrayItems","filter","item","dndcolumn","console","log","email","id","userEmail","replace","updates","forEach","element","index","rest","updateFirebaseNode","doSave","records","selectCaseArray","trashRecords","selectCaseArrayTrash","caseDNDArrayInitialRecords","map","pushKeyFirebaseNode","dndcontent","d","k","sum","caseDNDArrayInitialTrashRecords","caseDNDArrayInitial","concat","_toConsumableArray","Layout","DragAndDrop","Head","Seo","title","bsPrefix","active","prefix","defaultProps"],"sourceRoot":""}